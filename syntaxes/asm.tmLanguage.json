{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"scopeName": "text.vasm.oldstyle.asm",
	"foldingStartMarker": "^.+\\:$",
	"foldingStopMarker": "^!(  |\\\t)$",
	"patterns": [
		{ "include": "#comment" },
		{ "include": "#label" },
		{ "include": "#directive" },
		{ "include": "#expression" },
		{ "include": "#constant" }
	],
	"repository": {

		"comment": {
			"name": "comment.line",
			"match": "\\s*;.*$"
		},

		"label": {
			"match": "(?:^([a-z_]+):)|(?:^([a-z_]+) (macro)([^;]*))",
			"captures": {
				"1": {
					"name": "reference.label.asm"
				},
				"2": {
					"name": "reference.macro.asm"
				},
				"3": {
					"name": "directives.asm"
				}
			}
		},

		"constant": {
			"name": "definition",
			"match": "^([A-Z_]+) *= *([^;]+)",
			"captures": {
				"1": {
					"name": "reference.constant.asm"
				},
				"2": {
					"patterns": [ { "include": "#parameters" } ]
				}
			}
		},

		"parameters": {
			"begin": " ",
			"while": ",",
			"patterns": [
				{
					"name": "constant.numeric.hex",
					"match": "(#?)(\\$|0x)(0-9A-Fa-f)+"
				},
				{
					"name": "constant.numeric.octal",
					"match": "(#?)(0o)(0-8)+"
				},
				{
					"name": "constant.numeric.binary",
					"match": "(#?)(\\%|0b)(01)+"
				},
				{
					"name": "constant.numeric.decimal",
					"match": "(#?)(\\d)+"
				},
				{
					"name": "string.quoted",
					"match": "\".*?\""
				},
				{
					"name": "address.asm",
					"match": "(#?)[0-9A-z_\\-]"
				}
			]
		},

		"directive": {
			"match": "(?:^  | )(2byte|4byte|8byte|asciiz|ascii|align|balignl|balignw|balign|byte|comm|double|endmacro|endm|endr|equ|equiv|err|extern|fail|file|float|global|half|ifeq|ifne|ifgt|ifge|iflt|ifle|ifb|ifnb|ifdef|ifndef|if|incbin|incdir|include|int|irpc|irp|lcomm|list|local|long|macro|nolist|org|p2alignw|p2align|popsection|pushsection|quad|rept|section|set|size|short|single|skip|space|stabs|stabn|stabd|string|swbeg|type|uahalf|ualong|uaquad|uasort|uaword|weak|word|zero)([^;]*)",
			"captures": {
				"1": {
					"name": "directives.asm"
				},
				"2": {
					"patterns": [
						{ "include": "#parameters" }
					]
				}
			}
		},

		"sections": {
			"match": "(bss|data|rodata|sbss|sdata|sdata2|stab|stabstr|text|tocd|dpage)([^;]*)",
			"captures": {}
		},

		"expression": {
			"match": "^  (\\S+)( [^;]*)?",
			"captures": {
				"1": {
					"name": "instructionname.asm"
				},
				"2": {
					"patterns": [
						{ "include": "#parameters" }
					]
				}
			}
		}
		
	}
}